"""
author:
date:
brief:
"""


class UrlManager(object):
    def __init__(self):
        self.new_urls = set()
        self.old_urls = set()

    def has_new_url(self):
        """
        判断是否有未爬去的url
        :return:
        """
        return self.new_url_size != 0


    def get_new_url(self):
        """
        获取未爬去的url
        :return:
        """
        new_url = self.new_urls.pop()
        self.old_urls.add(new_url)
        return new_url

    def add_new_url(self, url):
        """
        添加url
        :param url:
        :return:
        """
        if url is None:
            return
        if url not in self.new_urls and url not in self.old_urls:
            self.new_urls.add(url)
            # print(self.new_urls)

    def add_new_urls(self, urls):
        """
        添加url集合
        :param urls:
        :return:
        """
        if urls is None or len(urls) == 0:
            return
        for url in urls:
            if url not in self.new_urls and url not in self.old_urls:
                self.new_urls.add(url)
        # print(self.new_urls)

    def new_url_size(self):
        """
        获取未爬去url集合的大小
        :return:
        """
        return len(self.new_urls)

    def old_url_size(self):
        """
        获取已经爬去的url大小
        :return:
        """
        return len(self.old_urls)

if __name__ == '__main__':
    url = UrlManager()
    url.add_new_urls({'http://seputu.com/zanghaihua/746.html', 'http://seputu.com/zanghaihua/709.html', 'http://seputu.com/zanghaihua/861.html', 'http://seputu.com/zanghaihua/910.html', 'http://seputu.com/zanghaihua/700.html', 'http://seputu.com/zanghaihua/656.html', 'http://seputu.com/zanghaihua/767.html', 'http://seputu.com/zanghaihua/697.html', 'http://seputu.com/zanghaihua/907.html', 'http://seputu.com/zanghaihua/678.html', 'http://seputu.com/zanghaihua/781.html', 'http://seputu.com/zanghaihua/801.html', 'http://seputu.com/zanghaihua/607.html', 'http://seputu.com/zanghaihua/690.html', 'http://seputu.com/zanghaihua/722.html', 'http://seputu.com/zanghaihua/823.html', 'http://seputu.com/zanghaihua/711.html', 'http://seputu.com/zanghaihua/812.html', 'http://seputu.com/zanghaihua/591.html', 'http://seputu.com/zanghaihua/685.html', 'http://seputu.com/zanghaihua/671.html', 'http://seputu.com/zanghaihua/716.html', 'http://seputu.com/zanghaihua/866.html', 'http://seputu.com/zanghaihua/985.html', 'http://seputu.com/zanghaihua/698.html', 'http://seputu.com/zanghaihua/798.html', 'http://seputu.com/zanghaihua/792.html', 'http://seputu.com/zanghaihua/987.html', 'http://seputu.com/zanghaihua/941.html', 'http://seputu.com/zanghaihua/706.html', 'http://seputu.com/zanghaihua/747.html', 'http://seputu.com/zanghaihua/982.html', 'http://seputu.com/zanghaihua/894.html', 'http://seputu.com/zanghaihua/631.html', 'http://seputu.com/zanghaihua/682.html', 'http://seputu.com/zanghaihua/971.html', 'http://seputu.com/zanghaihua/814.html', 'http://seputu.com/zanghaihua/712.html', 'http://seputu.com/zanghaihua/756.html', 'http://seputu.com/zanghaihua/726.html', 'http://seputu.com/zanghaihua/888.html', 'http://seputu.com/zanghaihua/983.html', 'http://seputu.com/zanghaihua/669.html', 'http://seputu.com/zanghaihua/829.html', 'http://seputu.com/zanghaihua/946.html', 'http://seputu.com/zanghaihua/972.html', 'http://seputu.com/zanghaihua/599.html', 'http://seputu.com/zanghaihua/707.html', 'http://seputu.com/zanghaihua/822.html', 'http://seputu.com/zanghaihua/751.html', 'http://seputu.com/zanghaihua/846.html', 'http://seputu.com/zanghaihua/950.html', 'http://seputu.com/zanghaihua/791.html', 'http://seputu.com/zanghaihua/719.html', 'http://seputu.com/zanghaihua/775.html', 'http://seputu.com/zanghaihua/593.html', 'http://seputu.com/zanghaihua/871.html', 'http://seputu.com/zanghaihua/919.html', 'http://seputu.com/zanghaihua/658.html', 'http://seputu.com/zanghaihua/688.html', 'http://seputu.com/zanghaihua/727.html', 'http://seputu.com/zanghaihua/895.html', 'http://seputu.com/zanghaihua/916.html', 'http://seputu.com/zanghaihua/737.html', 'http://seputu.com/zanghaihua/760.html', 'http://seputu.com/zanghaihua/885.html', 'http://seputu.com/zanghaihua/666.html', 'http://seputu.com/zanghaihua/634.html', 'http://seputu.com/zanghaihua/723.html', 'http://seputu.com/zanghaihua/909.html', 'http://seputu.com/zanghaihua/857.html', 'http://seputu.com/zanghaihua/802.html', 'http://seputu.com/zanghaihua/803.html', 'http://seputu.com/zanghaihua/635.html', 'http://seputu.com/zanghaihua/859.html', 'http://seputu.com/zanghaihua/640.html', 'http://seputu.com/zanghaihua/673.html', 'http://seputu.com/zanghaihua/733.html', 'http://seputu.com/zanghaihua/901.html', 'http://seputu.com/zanghaihua/612.html', 'http://seputu.com/zanghaihua/815.html', 'http://seputu.com/zanghaihua/957.html', 'http://seputu.com/zanghaihua/777.html', 'http://seputu.com/zanghaihua/773.html', 'http://seputu.com/zanghaihua/892.html', 'http://seputu.com/zanghaihua/835.html', 'http://seputu.com/zanghaihua/856.html', 'http://seputu.com/zanghaihua/955.html', 'http://seputu.com/zanghaihua/628.html', 'http://seputu.com/zanghaihua/641.html', 'http://seputu.com/zanghaihua/686.html', 'http://seputu.com/zanghaihua/764.html', 'http://seputu.com/zanghaihua/644.html', 'http://seputu.com/zanghaihua/920.html', 'http://seputu.com/zanghaihua/713.html', 'http://seputu.com/zanghaihua/840.html', 'http://seputu.com/zanghaihua/897.html', 'http://seputu.com/zanghaihua/687.html', 'http://seputu.com/zanghaihua/843.html', 'http://seputu.com/zanghaihua/953.html', 'http://seputu.com/zanghaihua/931.html', 'http://seputu.com/zanghaihua/977.html', 'http://seputu.com/zanghaihua/810.html', 'http://seputu.com/zanghaihua/651.html', 'http://seputu.com/zanghaihua/952.html', 'http://seputu.com/zanghaihua/933.html', 'http://seputu.com/zanghaihua/663.html', 'http://seputu.com/zanghaihua/752.html', 'http://seputu.com/zanghaihua/603.html', 'http://seputu.com/zanghaihua/676.html', 'http://seputu.com/zanghaihua/797.html', 'http://seputu.com/zanghaihua/947.html', 'http://seputu.com/zanghaihua/691.html', 'http://seputu.com/zanghaihua/787.html', 'http://seputu.com/zanghaihua/615.html', 'http://seputu.com/zanghaihua/667.html', 'http://seputu.com/zanghaihua/681.html', 'http://seputu.com/zanghaihua/968.html', 'http://seputu.com/zanghaihua/934.html', 'http://seputu.com/zanghaihua/715.html', 'http://seputu.com/zanghaihua/882.html', 'http://seputu.com/zanghaihua/943.html', 'http://seputu.com/zanghaihua/724.html', 'http://seputu.com/zanghaihua/935.html', 'http://seputu.com/zanghaihua/665.html', 'http://seputu.com/zanghaihua/677.html', 'http://seputu.com/zanghaihua/939.html', 'http://seputu.com/zanghaihua/988.html', 'http://seputu.com/zanghaihua/899.html', 'http://seputu.com/zanghaihua/662.html', 'http://seputu.com/zanghaihua/937.html', 'http://seputu.com/zanghaihua/884.html', 'http://seputu.com/zanghaihua/632.html', 'http://seputu.com/zanghaihua/790.html', 'http://seputu.com/zanghaihua/860.html', 'http://seputu.com/zanghaihua/783.html', 'http://seputu.com/zanghaihua/614.html', 'http://seputu.com/zanghaihua/826.html', 'http://seputu.com/zanghaihua/621.html', 'http://seputu.com/zanghaihua/597.html', 'http://seputu.com/zanghaihua/850.html', 'http://seputu.com/zanghaihua/624.html', 'http://seputu.com/zanghaihua/881.html', 'http://seputu.com/zanghaihua/730.html', 'http://seputu.com/zanghaihua/980.html', 'http://seputu.com/zanghaihua/854.html', 'http://seputu.com/zanghaihua/962.html', 'http://seputu.com/zanghaihua/633.html', 'http://seputu.com/zanghaihua/875.html', 'http://seputu.com/zanghaihua/928.html', 'http://seputu.com/zanghaihua/648.html', 'http://seputu.com/zanghaihua/647.html', 'http://seputu.com/zanghaihua/965.html', 'http://seputu.com/zanghaihua/613.html', 'http://seputu.com/zanghaihua/714.html', 'http://seputu.com/zanghaihua/945.html', 'http://seputu.com/zanghaihua/858.html', 'http://seputu.com/zanghaihua/903.html', 'http://seputu.com/zanghaihua/610.html', 'http://seputu.com/zanghaihua/915.html', 'http://seputu.com/zanghaihua/789.html', 'http://seputu.com/zanghaihua/627.html', 'http://seputu.com/zanghaihua/629.html', 'http://seputu.com/zanghaihua/608.html', 'http://seputu.com/zanghaihua/736.html', 'http://seputu.com/zanghaihua/743.html', 'http://seputu.com/zanghaihua/841.html', 'http://seputu.com/zanghaihua/848.html', 'http://seputu.com/zanghaihua/879.html', 'http://seputu.com/zanghaihua/649.html', 'http://seputu.com/zanghaihua/868.html', 'http://seputu.com/zanghaihua/605.html', 'http://seputu.com/zanghaihua/911.html', 'http://seputu.com/zanghaihua/914.html', 'http://seputu.com/zanghaihua/780.html', 'http://seputu.com/zanghaihua/938.html', 'http://seputu.com/zanghaihua/710.html', 'http://seputu.com/zanghaihua/872.html', 'http://seputu.com/zanghaihua/762.html', 'http://seputu.com/zanghaihua/738.html', 'http://seputu.com/zanghaihua/739.html', 'http://seputu.com/zanghaihua/824.html', 'http://seputu.com/zanghaihua/830.html', 'http://seputu.com/zanghaihua/703.html', 'http://seputu.com/zanghaihua/828.html', 'http://seputu.com/zanghaihua/923.html', 'http://seputu.com/zanghaihua/975.html', 'http://seputu.com/zanghaihua/674.html', 'http://seputu.com/zanghaihua/984.html', 'http://seputu.com/zanghaihua/754.html', 'http://seputu.com/zanghaihua/779.html', 'http://seputu.com/zanghaihua/761.html', 'http://seputu.com/zanghaihua/842.html', 'http://seputu.com/zanghaihua/836.html', 'http://seputu.com/zanghaihua/664.html', 'http://seputu.com/zanghaihua/749.html', 'http://seputu.com/zanghaihua/891.html', 'http://seputu.com/zanghaihua/770.html', 'http://seputu.com/zanghaihua/981.html', 'http://seputu.com/zanghaihua/758.html', 'http://seputu.com/zanghaihua/626.html', 'http://seputu.com/zanghaihua/753.html', 'http://seputu.com/zanghaihua/849.html', 'http://seputu.com/zanghaihua/986.html', 'http://seputu.com/zanghaihua/890.html', 'http://seputu.com/zanghaihua/967.html', 'http://seputu.com/zanghaihua/936.html', 'http://seputu.com/zanghaihua/645.html', 'http://seputu.com/zanghaihua/774.html', 'http://seputu.com/zanghaihua/598.html', 'http://seputu.com/zanghaihua/896.html', 'http://seputu.com/zanghaihua/905.html', 'http://seputu.com/zanghaihua/964.html', 'http://seputu.com/zanghaihua/694.html', 'http://seputu.com/zanghaihua/596.html', 'http://seputu.com/zanghaihua/796.html', 'http://seputu.com/zanghaihua/742.html', 'http://seputu.com/zanghaihua/956.html', 'http://seputu.com/zanghaihua/745.html', 'http://seputu.com/zanghaihua/809.html', 'http://seputu.com/zanghaihua/750.html', 'http://seputu.com/zanghaihua/929.html', 'http://seputu.com/zanghaihua/806.html', 'http://seputu.com/zanghaihua/701.html', 'http://seputu.com/zanghaihua/837.html', 'http://seputu.com/zanghaihua/646.html', 'http://seputu.com/zanghaihua/625.html', 'http://seputu.com/zanghaihua/699.html', 'http://seputu.com/zanghaihua/594.html', 'http://seputu.com/zanghaihua/601.html', 'http://seputu.com/zanghaihua/735.html', 'http://seputu.com/zanghaihua/786.html', 'http://seputu.com/zanghaihua/834.html', 'http://seputu.com/zanghaihua/883.html', 'http://seputu.com/zanghaihua/917.html', 'http://seputu.com/zanghaihua/870.html', 'http://seputu.com/zanghaihua/951.html', 'http://seputu.com/zanghaihua/969.html', 'http://seputu.com/zanghaihua/966.html', 'http://seputu.com/zanghaihua/973.html', 'http://seputu.com/zanghaihua/908.html', 'http://seputu.com/zanghaihua/636.html', 'http://seputu.com/zanghaihua/924.html', 'http://seputu.com/zanghaihua/718.html', 'http://seputu.com/zanghaihua/827.html', 'http://seputu.com/zanghaihua/867.html', 'http://seputu.com/zanghaihua/637.html', 'http://seputu.com/zanghaihua/725.html', 'http://seputu.com/zanghaihua/755.html', 'http://seputu.com/zanghaihua/684.html', 'http://seputu.com/zanghaihua/611.html', 'http://seputu.com/zanghaihua/793.html', 'http://seputu.com/zanghaihua/847.html', 'http://seputu.com/zanghaihua/600.html', 'http://seputu.com/zanghaihua/887.html', 'http://seputu.com/zanghaihua/900.html', 'http://seputu.com/zanghaihua/765.html', 'http://seputu.com/zanghaihua/869.html', 'http://seputu.com/zanghaihua/863.html', 'http://seputu.com/zanghaihua/729.html', 'http://seputu.com/zanghaihua/679.html', 'http://seputu.com/zanghaihua/785.html', 'http://seputu.com/zanghaihua/609.html', 'http://seputu.com/zanghaihua/660.html', 'http://seputu.com/zanghaihua/889.html', 'http://seputu.com/zanghaihua/944.html', 'http://seputu.com/zanghaihua/759.html', 'http://seputu.com/zanghaihua/776.html', 'http://seputu.com/zanghaihua/963.html', 'http://seputu.com/zanghaihua/617.html', 'http://seputu.com/zanghaihua/864.html', 'http://seputu.com/zanghaihua/844.html', 'http://seputu.com/zanghaihua/620.html', 'http://seputu.com/zanghaihua/954.html', 'http://seputu.com/zanghaihua/695.html', 'http://seputu.com/zanghaihua/833.html', 'http://seputu.com/zanghaihua/874.html', 'http://seputu.com/zanghaihua/604.html', 'http://seputu.com/zanghaihua/852.html', 'http://seputu.com/zanghaihua/821.html', 'http://seputu.com/zanghaihua/748.html', 'http://seputu.com/zanghaihua/766.html', 'http://seputu.com/zanghaihua/926.html', 'http://seputu.com/zanghaihua/720.html', 'http://seputu.com/zanghaihua/913.html', 'http://seputu.com/zanghaihua/659.html', 'http://seputu.com/zanghaihua/800.html', 'http://seputu.com/zanghaihua/618.html', 'http://seputu.com/zanghaihua/650.html', 'http://seputu.com/zanghaihua/657.html', 'http://seputu.com/zanghaihua/732.html', 'http://seputu.com/zanghaihua/794.html', 'http://seputu.com/zanghaihua/839.html', 'http://seputu.com/zanghaihua/845.html', 'http://seputu.com/zanghaihua/717.html', 'http://seputu.com/zanghaihua/731.html', 'http://seputu.com/zanghaihua/696.html', 'http://seputu.com/zanghaihua/880.html', 'http://seputu.com/zanghaihua/795.html', 'http://seputu.com/zanghaihua/606.html', 'http://seputu.com/zanghaihua/940.html', 'http://seputu.com/zanghaihua/808.html', 'http://seputu.com/zanghaihua/643.html', 'http://seputu.com/zanghaihua/832.html', 'http://seputu.com/zanghaihua/653.html', 'http://seputu.com/zanghaihua/816.html', 'http://seputu.com/zanghaihua/788.html', 'http://seputu.com/zanghaihua/693.html', 'http://seputu.com/zanghaihua/721.html', 'http://seputu.com/zanghaihua/932.html', 'http://seputu.com/zanghaihua/974.html', 'http://seputu.com/zanghaihua/616.html', 'http://seputu.com/zanghaihua/902.html', 'http://seputu.com/zanghaihua/623.html', 'http://seputu.com/zanghaihua/820.html', 'http://seputu.com/zanghaihua/638.html', 'http://seputu.com/zanghaihua/877.html', 'http://seputu.com/zanghaihua/689.html', 'http://seputu.com/zanghaihua/912.html', 'http://seputu.com/zanghaihua/825.html', 'http://seputu.com/zanghaihua/818.html', 'http://seputu.com/zanghaihua/630.html', 'http://seputu.com/zanghaihua/918.html', 'http://seputu.com/zanghaihua/978.html', 'http://seputu.com/zanghaihua/771.html', 'http://seputu.com/zanghaihua/782.html', 'http://seputu.com/zanghaihua/769.html', 'http://seputu.com/zanghaihua/979.html', 'http://seputu.com/zanghaihua/960.html', 'http://seputu.com/zanghaihua/878.html', 'http://seputu.com/zanghaihua/670.html', 'http://seputu.com/zanghaihua/778.html', 'http://seputu.com/zanghaihua/708.html', 'http://seputu.com/zanghaihua/927.html', 'http://seputu.com/zanghaihua/805.html', 'http://seputu.com/zanghaihua/865.html', 'http://seputu.com/zanghaihua/904.html', 'http://seputu.com/zanghaihua/799.html', 'http://seputu.com/zanghaihua/817.html', 'http://seputu.com/zanghaihua/925.html', 'http://seputu.com/zanghaihua/740.html', 'http://seputu.com/zanghaihua/948.html', 'http://seputu.com/zanghaihua/851.html', 'http://seputu.com/zanghaihua/692.html', 'http://seputu.com/zanghaihua/622.html', 'http://seputu.com/zanghaihua/639.html', 'http://seputu.com/zanghaihua/661.html', 'http://seputu.com/zanghaihua/744.html', 'http://seputu.com/zanghaihua/705.html', 'http://seputu.com/zanghaihua/784.html', 'http://seputu.com/zanghaihua/592.html', 'http://seputu.com/zanghaihua/680.html', 'http://seputu.com/zanghaihua/595.html', 'http://seputu.com/zanghaihua/757.html', 'http://seputu.com/zanghaihua/619.html', 'http://seputu.com/zanghaihua/831.html', 'http://seputu.com/zanghaihua/734.html', 'http://seputu.com/zanghaihua/876.html', 'http://seputu.com/zanghaihua/654.html', 'http://seputu.com/zanghaihua/807.html', 'http://seputu.com/zanghaihua/873.html', 'http://seputu.com/zanghaihua/959.html', 'http://seputu.com/zanghaihua/683.html', 'http://seputu.com/zanghaihua/949.html', 'http://seputu.com/zanghaihua/898.html', 'http://seputu.com/zanghaihua/768.html', 'http://seputu.com/zanghaihua/672.html', 'http://seputu.com/zanghaihua/989.html', 'http://seputu.com/zanghaihua/772.html', 'http://seputu.com/zanghaihua/655.html', 'http://seputu.com/zanghaihua/930.html', 'http://seputu.com/zanghaihua/804.html', 'http://seputu.com/zanghaihua/838.html', 'http://seputu.com/zanghaihua/906.html', 'http://seputu.com/zanghaihua/602.html', 'http://seputu.com/zanghaihua/853.html', 'http://seputu.com/zanghaihua/642.html', 'http://seputu.com/zanghaihua/862.html', 'http://seputu.com/zanghaihua/922.html', 'http://seputu.com/zanghaihua/961.html', 'http://seputu.com/zanghaihua/970.html', 'http://seputu.com/zanghaihua/942.html', 'http://seputu.com/zanghaihua/741.html', 'http://seputu.com/zanghaihua/675.html', 'http://seputu.com/zanghaihua/855.html', 'http://seputu.com/zanghaihua/819.html', 'http://seputu.com/zanghaihua/886.html', 'http://seputu.com/zanghaihua/652.html', 'http://seputu.com/zanghaihua/811.html', 'http://seputu.com/zanghaihua/702.html', 'http://seputu.com/zanghaihua/704.html', 'http://seputu.com/zanghaihua/976.html', 'http://seputu.com/zanghaihua/763.html', 'http://seputu.com/zanghaihua/728.html', 'http://seputu.com/zanghaihua/668.html', 'http://seputu.com/zanghaihua/958.html', 'http://seputu.com/zanghaihua/813.html', 'http://seputu.com/zanghaihua/893.html', 'http://seputu.com/zanghaihua/921.html'}
)
    print(url.new_urls)
